<!doctype html><meta charset=utf-8><title>SocialGraph</title><style>body{font-family:'Helvetica Neue',Helvetica,Verdana,Arial}a{color:#666;text-decoration:none}canvas,nav{display:block;position:fixed;left:0;top:0}canvas{width:100%;height:100%}#panel{display:block;position:fixed;width:50%;left:25%;max-height:80%;top:10%;overflow-y:scroll;background:#fff;padding:10px;box-shadow:0 5px 5px rgba(0,0,0,.4);border:1px #bbb solid}.right,nav button,#Close{float:right}nav{right:0;padding:2px 5px}button{border:1px #ddd solid;border-bottom-color:#bbb;background-color:#f5f5f5;background-image:linear-gradient(transparent,rgba(0,0,0,.2));padding:3px 9px;border-radius:3px;font-size:12px;font-weight:600;color:#666;text-shadow:0 1px 0 #fff;box-shadow:0 1px 0 #fff;margin:0 1px}button:hover{background-image:linear-gradient(transparent,rgba(0,0,0,.3));color:#222}button:hover,#meta{cursor:pointer}#New,#New:hover{background-color:#8add6d;border-color:#74bb5a #74bb5a #509438;text-shadow:0 1px 0 #666;color:#fff}#Close{color:#f00}label{display:inline-block;width:120px}</style><script>var d,f,h="223,87,69 40,207,174 99,129,208 138,219,76 205,167,31 211,81,177 93,161,72".split(" "),k=[{id:"GNU-GPL",name:"GNU General Public License",url:"//www.gnu.org/licenses/gpl.html"},{id:"GNU-FDL",name:"GNU Free Documentation License",url:"//www.gnu.org/licenses/fdl.html"},{id:"CC-BY-SA",name:"Creative Commons Attribution and Share-alike License",url:"//creativecommons.org/licenses/by-sa/3.0/"},{id:"CC-BY",name:"Creative Commons Attribution",url:"//creativecommons.org/licenses/by/3.0/"},{id:"CC-BY-NC-SA", name:"Creative Commons Attribution, Non-commercial and Share-alike",url:"//creativecommons.org/licenses/by-nc-sa/3.0/"},{id:"CC-BY-NC-ND",name:"Creative Commons Attribution, Non-commercial and No-derivatives",url:"//creativecommons.org/licenses/by-nc-nd/3.0/"},{id:"CC-0",name:"Creative Commons Public Domain Dedication",url:"//creativecommons.org/licenses/../publicdomain/zero/1.0/"},{id:"COPYRIGHT",name:"Copyright "+(new Date).getFullYear()+". All right reserved",url:"//en.wikipedia.org/wiki/Copyright"}, {id:"WTFPL",name:"Do What The Fuck You Want License",url:"http://www.wtfpl.net/about/"}],l=document.location.protocol+"//socialgraph.boudah.pl/",m=["Organization","People","Project"],n=[],p={metadata:{title:"An untitled social graph",authors:["Anonymous"],created:(new Date).toGMTString(),visibility:"private",license:"COPYRIGHT"},vertices:[]};function q(a,b){this.x=a;this.y=b;this.a=function(a){return r(this.x+a.x,this.y+a.y)};this.c=function(a){return r(this.x-a.x,this.y-a.y)};this.b=function(a){return r(this.x*a,this.y*a)};this.g=function(a){return this.x*a.x+this.y*a.y};this.f=function(){return Math.sqrt(this.g(this))};this.e=function(a){return this.c(a).f()};return this}function r(a,b){return new q(a,b)}function s(a){if(!a.members||!(a.members instanceof Array))a.members=[];a.position||(a.position=r((Math.random()-0.5)*d.width,(Math.random()-0.5)*d.height));if(!a.color||"string"!==typeof a.color)a.color=h[Math.round(Math.random()*h.length)];this.title=a.title;this.type=a.type;this.l=a.l;this.description=a.description;this.i=a.i;this.e=1+a.members.length;this.a=20*Math.sqrt(this.e);this.position=a.position;this.links=a.links;this.members=a.members;this.color=a.color;this.c=function(a){return this.position.e(a.position)};this.f=function(){for(var a=r(0,0),c=0,g=p.vertices.length;c<g;c++){var e=new s(p.vertices[c]);if(e.title!=this.title)var j=e.c(this)/(this.a+e.a+180),a=a.a(e.position.c(this.position).b((j-1)/(j*j)/e.c(this)))}return a=a.a(this.position.b(-0.0020*this.e))};this.g=function(){this.position=this.position.a(this.f().b(1));return this};this.j=function(a){var c=this.position.a(d.d),g=a?1:0.6,e=this.a,j=Math.ceil(2.5*Math.sqrt(e));d.beginPath();d.lineWidth=a?3:1;d.fillStyle="rgba("+this.color+","+g/2+")";d.strokeStyle="rgba("+this.color+","+g+")";this.type==m[0]?d.arc(c.x,c.y,e,0,6.283185):this.type==m[1]?this.b([c.a(r(-e,-e)),c.a(r(e,-e)),c.a(r(e,e)),c.a(r(-e,e))]):this.b([c.a(r(-e,0)),c.a(r(0,-e)),c.a(r(e,0)),c.a(r(0,e))]);d.closePath();d.stroke();d.fill();d.fillStyle="#000";d.font="600 "+j+"px Helvetica";d.textAlign="center";d.fillText(this.title,c.x,c.y+j/4);return this};this.k=function(a,c){var g=this.position.a(d.d),e=a.position.a(d.d),j=e.c(g),v=g.e(e),g=j.b(this.a/v).a(g),e=j.b(-1*a.a/v).a(e), I=r(j.x-j.y,j.y+j.x).b(-7.5/v).a(e),j=r(j.x+j.y,j.y-j.x).b(-7.5/v).a(e);d.beginPath();d.lineWidth=c?3:1;d.strokeStyle="rgba("+this.color+",.8)";this.b([g,e,I]).b([e,j]);d.stroke()};this.b=function(a){for(var c=0,g=a.length;c<g;c++)0==c?d.moveTo(a[c].x,a[c].y):d.lineTo(a[c].x,a[c].y);return this};return this}function t(a){for(var b=0,c=p.vertices.length;b<c;b++)if(p.vertices[b].title==a)return b;return-1}function u(){d.clearRect(0,0,d.width,d.height);for(var a=0,b=p.vertices.length;a<b;a++){var c=-1!==n.indexOf(a);p.vertices[a]=(new s(p.vertices[a])).g().j(c);for(var g in p.vertices[a].links)p.vertices[a].k(new s(p.vertices[t(g)]),c)}setTimeout(u,1)}function w(){var a=window.innerHeight,b=window.innerWidth;if(d.width!=b||d.height!=a){var c=x("canvas");c.width=b;c.height=a;d.width=b;d.height=a;d.d=r(b/2,a/2)}window.setTimeout(w,1E3)}function y(){var a;a:{a=d.h;for(var b=0,c=p.vertices.length;b<c;b++){var g=new s(p.vertices[b]);if(a.c(g.position).f()<g.a){a=b;break a}}a=-1}0>a?(z(),n=[]):n=[a]}function A(){var a=x("menu")?x("menu"):B("nav","menu"),b;a:{b=p.metadata.license;for(var c=0,g=k.length;c<g;c++)if(k[c].id==b){b='<a href="'+k[c].url+'" target=_blank title="'+k[c].name+'" rel=license>'+b+"</a>";break a}b=""}a.innerHTML=C("strong",p.metadata.title,"meta")+" by <em>"+p.metadata.authors.join()+"</em> ("+b+")"+D("Help")+D("Share")+D("Import")+D("Save")+D("New");document.title=p.metadata.title+" | SocialGraph";x("New").onclick=E;x("Save").onclick=F;x("Import").onclick=G;x("Share").onclick=H;x("Help").onclick=J;x("meta").onclick=K}function K(){L("Edit graph options","")}function L(a,b){x("panel")||B("section","panel");x("panel").innerHTML=D("Close")+"<h1>"+a+"</h1>"+b;x("Close").onclick=z;document.body.style.backgroundColor="#ddd"}function z(){var a=x("panel");a&&document.body.removeChild(a);document.body.style.backgroundColor="#fff"}function E(){for(var a=1;-1!=t("#"+a);){if(99<a)return;a++}p.vertices.push(new s({title:"#"+a,type:m[0],position:d.h}));n=[p.vertices.length-1];M()}function F(){for(var a={},b=0,c=k.length;b<c;b++)a[k[b].id]=k[b].name;L("Save this graph",D("saveOffline","Save on my computer")+"<hr>"+D("saveOnline","Save on the web")+' with the password <input type=password id=graphPass value=""> and visible to </label> '+N("graphVisibility",{"private":"me (with the password)","protected":"those who have the link","public":"everyone (public)"},p.metadata.visibility)+". Publish under "+N("graphLicense",a,p.metadata.license)+"<hr>"+D("Download")+" the "+N("exportData", ["Graph","Contacts"])+" in the "+N("exportFormat",["JSON","Atom"])+" format.");x("Download").onclick=O;x("saveOffline").onclick=P}function G(){L("Import from","(Coming soon)")}function M(){if(0!=n.length){var a=p.vertices[n[0]];L("Edit this element","<label for=vertexType>Type:</label> "+N("vertexType",m,a.type)+'<br><label for=vertexTitle>Title:</label> <input type=text maxlength=30 id=vertexTitle value="'+a.title+'"><br><label for=vertexDescription>Description:</label> <input type=text maxlength=100 id=vertexDescription value="'+a.description+'">');x("vertexType").onchange=Q;x("vertexTitle").onchange=Q;x("vertexDescription").onchange=Q}}function Q(){var a=n[0];p.vertices[a].type=x("vertexType").value;p.vertices[a].title=x("vertexTitle").value;p.vertices[a].description=x("vertexDescription").value;M()}function P(){R("Not implemented yet !")}function R(a){L("Argh!","An error happened, because "+a)}function J(){L("Help",'<p>SocialGraph aims to better understand a social network showing an intuitive dynamics of individuals and organizations that make up a network. It creates human-readable dynamics graph that you can export everywhere, and even use offline (just by saving this webpage on your computer).</p><ul><li><a href="//github.com/talenka/socialgraph/wiki/getting-started" target=_blank>Getting started</a></li></ul><p>This is a brand new project, if you are interested, join us on <a href="//github.com/talenka/socialgraph/" target=_blank>github</a>, where comments and <a href="//github.com/talenka/socialgraph/issues" target=_blank>bugs reports</a> are welcomed.</p>')}function H(){L("Share this graph","<p>Coming soon...</p><ul><li>Twitter</li><li>Facebook</li><li>Google+</li><li>Pinterest</li></ul>")}function O(){var a=x("exportFormat").value,b="";if("Graph"==x("exportData").value)if("JSON"==a)b=window.JSON.stringify(p);else if("Atom"==a){for(var b='<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom">'+C("title",p.metadata.title)+C("subtitle","A social graph")+'<link href="'+l+'"/>'+C("updated",p.metadata.created)+C("author",C("name",p.metadata.authors[0])),a=0,c=p.vertices.length;a<c;a++)b+=C("entry",C("title",p.vertices[a].title)+'<link href="'+l+'"/>'+C("updated", p.metadata.created)+C("summary",p.vertices[a].description));b+="</feed>"}""==b?R("this function is not yet implemented :-("):L("Output",C("textarea",b))}function x(a){return document.getElementById(a)}function B(a,b){var c=document.createElement(a);c.setAttribute("id",b);document.body.appendChild(c);return c}function S(a){d.h=r(a.clientX,a.clientY).c(d.d)}function N(a,b,c){var g="",e;for(e in b)var j=b instanceof Array?b[e]:e,g=g+('<option value="'+j+'"'+(j==c?"selected=selected":"")+">"+b[e]+"</option>");return C("select",g,a)}function C(a,b,c){return"<"+a+(c?" id="+c:"")+">"+(b?b:"")+"</"+a+">"}function D(a,b){return C("button",b?b:a,a)}window.onload=function(){var a=B("canvas","canvas"),b=window.innerHeight,c=window.innerWidth;d=a.getContext("2d");d.width=a.width=c;d.height=a.height=b;a.onclick=y;a.ondblclick=M;d.d=r(c/2,b/2);d.zoom=1;d.h=r(0,0);a=document.location.href.split("#");a instanceof Array&&(a=a[0]);a=a.split("?");a instanceof Array&&2==a.length&&(b=a[1],2<b.length&&/^\w+$/.test(b)&&(a=l+"get?"+a[1],f=new window.XMLHttpRequest,f.open("GET",a,!0),f.send(null),f.onreadystatechange=function(){if(4==f.readyState)if(200==f.status){var a=window.JSON.parse(f.responseText);a&&a.metadata&&a.metadata instanceof Object&&a.vertices&&a.vertices instanceof Array?p=Object(a):R("there is a vergence in the Force");A()}else R("the server do not respond properly (ajax)")}));A();u();window.onmousemove=S;w()};</script>