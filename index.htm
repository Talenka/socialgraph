<!doctype html><meta charset=utf8><title>SocialGraph</title><meta name=viewport content="width=device-width"><style>body{font-family:'Helvetica Neue',Helvetica,Verdana,Arial}a{color:#369;text-decoration:none}canvas,nav{display:block;position:fixed;left:0;top:0}canvas{width:100%;height:100%}#panel{display:block;position:fixed;width:50%;max-width:600px;left:25%;max-height:80%;top:10%;overflow-y:scroll;background:#fff;padding:10px;box-shadow:0 5px 5px rgba(0,0,0,.4);border:1px #bbb solid}.right,nav button,#Close{float:right}nav{right:0;padding:2px 5px}button{border:1px #ddd solid;border-bottom-color:#bbb;background-color:#f5f5f5;background-image:linear-gradient(transparent,rgba(0,0,0,.2));padding:3px 9px;border-radius:3px;font-size:12px;font-weight:600;color:#666;text-shadow:0 1px 0 #fff;box-shadow:0 1px 0 #fff;margin:0 1px}button:hover{background-image:linear-gradient(transparent,rgba(0,0,0,.3));color:#222}button:hover,#meta{cursor:pointer}#New,#New:hover{background-color:#8add6d;border-color:#74bb5a #74bb5a #509438;text-shadow:0 1px 0 #666;color:#fff}#Close{color:#f00}label{display:inline-block;clear:left;width:20%;min-width:120px}input,select{font-size:inherit;margin:1px}input{width:70%}textarea{width:100%;min-height:200px}</style><script>'use strict';var d,e,f=[],l={metadata:{title:"An untitled social graph",authors:["Anonymous"],created:(new Date).toGMTString(),visibility:"private",license:"COPYRIGHT",alias:"untitled"},vertices:[]}; window.onload=function(){var a=m("canvas","canvas"),c=window.innerHeight,b=window.innerWidth;d=a.getContext("2d");d.width=a.width=b;d.height=a.height=c;a.onclick=n;a.ondblclick=p;d.d=q(b/2,c/2);d.zoom=1;d.h=q(0,0);a=document.location.href.split("#");a instanceof Array&&(a=a[0]);a=a.split("?");a instanceof Array&&2==a.length&&(c=a[1],2<c.length&&/^\w+$/.test(c)&&r(s+"get?"+a[1]));t();u();window.onmousemove=v;w()};function x(a,c){this.x=a;this.y=c;this.a=function(a){return q(this.x+a.x,this.y+a.y)};this.c=function(a){return q(this.x-a.x,this.y-a.y)};this.b=function(a){return q(this.x*a,this.y*a)};this.k=function(a){return this.x*a.x+this.y*a.y};this.f=function(){return Math.sqrt(this.k(this))};this.e=function(a){return this.c(a).f()};return this}function q(a,c){return new x(a,c)};function y(a){return document.getElementById(a)}function m(a,c){var b=document.createElement(a);b.setAttribute("id",c);document.body.appendChild(b);return b}function v(a){d.h=q(a.clientX,a.clientY).c(d.d)}function z(a,c,b){var h="",g;for(g in c)var k=c instanceof Array?c[g]:g,h=h+('<option value="'+k+'"'+(k==b?"selected=selected":"")+">"+c[g]+"</option>");return B("select",h,a)}function B(a,c,b){return"<"+a+(b?" id="+b:"")+">"+(c?c:"")+"</"+a+">"}function C(a,c){return B("button",c?c:a,a)};function D(){var a=y("exportFormat").value,c="";if("Graph"==y("exportData").value)if("JSON"==a)c=window.JSON.stringify(l);else if("Atom"==a){for(var c='<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom">'+B("title",l.metadata.title)+B("subtitle","A social graph")+'<link href="'+s+'"/>'+B("updated",l.metadata.created)+B("author",B("name",l.metadata.authors[0])),a=0,b=l.vertices.length;a<b;a++)c+=B("entry",B("title",l.vertices[a].title)+'<link href="'+s+'"/>'+B("updated", l.metadata.created)+B("summary",l.vertices[a].description));c+="</feed>"}""==c?E("this function is not yet implemented :-("):F("Output",B("textarea",c))}function G(a,c,b){e=new window.XMLHttpRequest;e.open(b?"POST":"GET",a,!0);b?(e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send(b)):e.send(null);e.onreadystatechange=function(){4==e.readyState&&(200==e.status?c(e.responseText):E("the server do not respond properly (ajax)"))}} function r(a){G(a,function(a){if((a=window.JSON.parse(a))&&a.metadata&&a.metadata instanceof Object&&a.vertices&&a.vertices instanceof Array){for(var b=0,h=a.vertices.length;b<h;b++)a.vertices[b]=new H(a.vertices[b]),a.vertices[b].position=q(a.vertices[b].position.x,a.vertices[b].position.y);l=Object(a)}else E("there is a vergence in the Force");t()})};var I=window.navigator.userAgent,I=window.opera?"Opera":-1!=I.indexOf("Chrome")?"Chrome":-1!=I.indexOf("Firefox")?"Firefox":"the browser",J=[{id:"GNU-GPL",name:"GNU General Public License",url:"//www.gnu.org/licenses/gpl.html"},{id:"GNU-FDL",name:"GNU Free Documentation License",url:"//www.gnu.org/licenses/fdl.html"},{id:"CC-BY-SA",name:"Creative Commons Attribution and Share-alike License",url:"//creativecommons.org/licenses/by-sa/3.0/"},{id:"CC-BY",name:"Creative Commons Attribution",url:"//creativecommons.org/licenses/by/3.0/"}, {id:"CC-BY-NC-SA",name:"Creative Commons Attribution, Non-commercial and Share-alike",url:"//creativecommons.org/licenses/by-nc-sa/3.0/"},{id:"CC-BY-NC-ND",name:"Creative Commons Attribution, Non-commercial and No-derivatives",url:"//creativecommons.org/licenses/by-nc-nd/3.0/"},{id:"CC-0",name:"Creative Commons Public Domain Dedication",url:"//creativecommons.org/licenses/../publicdomain/zero/1.0/"},{id:"COPYRIGHT",name:"Copyright "+(new Date).getFullYear()+". All right reserved",url:"//en.wikipedia.org/wiki/Copyright"}, {id:"WTFPL",name:"Do What The Fuck You Want License",url:"http://www.wtfpl.net/about/"}],K={"private":"me (with the password)","protected":"those who have the link","public":"everyone (public)"},s=document.location.protocol+"//socialgraph.boudah.pl/"; function t(){var a=y("menu")?y("menu"):m("nav","menu"),c;a:{c=l.metadata.license;for(var b=0,h=J.length;b<h;b++)if(J[b].id==c){c='<a href="'+J[b].url+'" target=_blank title="'+J[b].name+'" rel=license>'+c+"</a>";break a}c=""}a.innerHTML=B("strong",l.metadata.title,"meta")+" by <em>"+l.metadata.authors.join()+"</em> ("+c+")"+C("Help")+C("Share")+C("Import")+C("Save")+C("New");document.title=l.metadata.title+" | SocialGraph";y("New").onclick=L;y("Save").onclick=M;y("Import").onclick=N;y("Share").onclick= O;y("Help").onclick=P;y("meta").onclick=Q} function Q(){for(var a={},c=0,b=J.length;c<b;c++)a[J[c].id]=J[c].name;F("Edit graph options",'<label for=graphTitle>Graph title:</label> <input type=text maxlength=30 id=graphTitle value="'+l.metadata.title+'"><br><label for=graphAuthors>Authors:</label> <input type=text maxlength=100 id=graphAuthors value="'+l.metadata.authors.join(", ")+'"><br><label for=graphVisibility>Visible to:</label> '+z("graphVisibility",K,l.metadata.visibility)+"<br><label for=graphLicense>Publish under:</label> "+z("graphLicense", a,l.metadata.license)+"<br>Graph created "+(new Date(l.metadata.created)).toLocaleString());y("graphTitle").onchange=R;y("graphAuthors").onchange=R;y("graphVisibility").onchange=R;y("graphLicense").onchange=R}function R(){l.metadata.title=y("graphTitle").value;l.metadata.visibility=y("graphVisibility").value;l.metadata.license=y("graphLicense").value;l.metadata.authors=y("graphAuthors").value.split(",").map(function(a){return a.replace(/(^\s+|\s+$)/g,"").replace(/\s+/g," ")});t()} function F(a,c){y("panel")||m("section","panel");y("panel").innerHTML=C("Close")+"<h1>"+a+"</h1>"+c;y("Close").onclick=S;document.body.style.backgroundColor="#ddd"}function S(){var a=y("panel");a&&document.body.removeChild(a);document.body.style.backgroundColor="#fff"}function L(){for(var a=1;-1!=T("#"+a);){if(99<a)return;a++}l.vertices.push(new H({title:"#"+a,type:U[0],position:d.h}));f=[l.vertices.length-1];p()} function M(){F("Save this graph",C("saveOffline","Save in "+I)+"<hr>"+C("saveOnline","Save on the web")+"<br>"+s+'?<input id=graphAlias value="'+V(l.metadata.alias)+'" maxlength=120><br>with the password <input type=password id=graphPass value=""> and visible to '+z("graphVisibility",K,l.metadata.visibility)+".<hr>"+C("Download")+" the "+z("exportData",["Graph","Contacts"])+" in the "+z("exportFormat",["JSON","Atom"])+" format.");W(l.metadata.alias);y("graphAlias").onchange=function(){W(y("graphAlias").value)}; y("Download").onclick=D;y("saveOffline").onclick=X;y("saveOnline").onclick=Y}function W(a){G(s+"getAlias?"+V(a),function(a){y("graphAlias").value=l.metadata.alias=a})}function V(a){return a.replace(/\W+/g," ").replace(/(^\s+|\s+$)/g,"").replace(/ /g,"_").toLowerCase()}function N(){F("Import from","(Coming soon)")} function p(){if(0!=f.length){var a=l.vertices[f[0]];F("Edit this element","<label for=vertexType>Type:</label> "+z("vertexType",U,a.type)+'<br><label for=vertexTitle>Title:</label> <input type=text maxlength=30 id=vertexTitle value="'+a.title+'"><br><label for=vertexDescription>Description:</label> <input type=text maxlength=100 id=vertexDescription value="'+a.description+'"><label for=vertexImage>Image:</label> <input type=text maxlength=100 id=vertexImage value="'+(a.g?a.g.src:"")+'">');y("vertexType").onchange= Z;y("vertexTitle").onchange=Z;y("vertexDescription").onchange=Z}}function Z(){var a=f[0];l.vertices[a].type=y("vertexType").value;l.vertices[a].title=y("vertexTitle").value;l.vertices[a].description=y("vertexDescription").value;p()}function X(){E("Not implemented yet !")} function Y(){F("Saving graph on the world wild web...","");G(s+"save?"+l.metadata.visibility+"/"+l.metadata.alias,function(a){(a=window.JSON.parse(a))?a.url?window.location=a.url:E(a.status):E("Server responded in a unknown language!")},"json_content="+escape(window.JSON.stringify(l)))}function E(a){F("Argh!","An error happened, because "+a)} function P(){F("Help",'<p>SocialGraph aims to better understand a social network showing an intuitive dynamics of individuals and organizations that make up a network. It creates human-readable dynamics graph that you can export everywhere, and even use offline (just by saving this webpage on your computer).</p><ul><li><a href="//github.com/talenka/socialgraph/wiki/getting-started" target=_blank>Getting started</a></li></ul><p>This is a brand new project, if you are interested, join us on <a href="//github.com/talenka/socialgraph/" target=_blank>github</a>, where comments and <a href="//github.com/talenka/socialgraph/issues" target=_blank>bugs reports</a> are welcomed.</p>')} function O(){F("Share this graph","<p>Coming soon...</p><ul><li>Twitter</li><li>Facebook</li><li>Google+</li><li>Pinterest</li></ul>")}function u(){d.clearRect(0,0,d.width,d.height);for(var a=0,c=l.vertices.length;a<c;a++){var b=-1!==f.indexOf(a);l.vertices[a]=(new H(l.vertices[a])).e().j(b);for(var h in l.vertices[a].links)l.vertices[a].f(new H(l.vertices[T(h)]),b)}setTimeout(u,1)} function w(){var a=window.innerHeight,c=window.innerWidth;if(d.width!=c||d.height!=a){var b=y("canvas");b.width=c;b.height=a;d.width=c;d.height=a;d.d=q(c/2,a/2)}window.setTimeout(w,1E3)}function n(){var a;a:{a=d.h;for(var c=0,b=l.vertices.length;c<b;c++){var h=new H(l.vertices[c]);if(a.c(h.position).f()<h.radius){a=c;break a}}a=-1}0>a?(S(),f=[]):f=[a]};var $="223,87,69 40,207,174 99,129,208 138,219,76 205,167,31 211,81,177 93,161,72".split(" "),U=["Organization","People","Project"]; function H(a){a.members&&a.members instanceof Array||(a.members=[]);a.position||(a.position=q((Math.random()-0.5)*d.width,(Math.random()-0.5)*d.height));a.color&&"string"===typeof a.color||(a.color=$[Math.round(Math.random()*$.length)]);this.title=a.title;this.type=a.type;this.g=a.g;this.description=a.description;this.i=a.i;this.mass=1+a.members.length;this.radius=20*Math.sqrt(this.mass);this.position=a.position;this.links=a.links;this.members=a.members;this.color=a.color;this.b=function(a){return this.position.e(a.position)}; this.c=function(){for(var a=q(0,0),b=0,h=l.vertices.length;b<h;b++){var g=new H(l.vertices[b]);if(g.title!=this.title)var k=g.b(this)/(this.radius+g.radius+180),a=a.a(g.position.c(this.position).b((k-1)/(k*k)/g.b(this)))}return a=a.a(this.position.b(-0.0020*this.mass))};this.e=function(){this.position=this.position.a(this.c().b(1));return this};this.j=function(a){var b=this.position.a(d.d),h=a?1:0.6,g=this.radius,k=Math.ceil(2.5*Math.sqrt(g));d.beginPath();d.lineWidth=a?3:1;d.fillStyle="rgba("+this.color+ ","+h/2+")";d.strokeStyle="rgba("+this.color+","+h+")";this.type==U[0]?d.arc(b.x,b.y,g,0,6.283185):this.type==U[1]?this.a([b.a(q(-g,-g)),b.a(q(g,-g)),b.a(q(g,g)),b.a(q(-g,g))]):this.a([b.a(q(-g,0)),b.a(q(0,-g)),b.a(q(g,0)),b.a(q(0,g))]);d.closePath();d.stroke();d.fill();d.fillStyle="#000";d.font="600 "+k+"px Helvetica";d.textAlign="center";d.fillText(this.title,b.x,b.y+k/4);return this};this.f=function(a,b){var h=this.position.a(d.d),g=a.position.a(d.d),k=g.c(h),A=h.e(g),h=k.b(this.radius/A).a(h), g=k.b(-1*a.radius/A).a(g),aa=q(k.x-k.y,k.y+k.x).b(-7.5/A).a(g),k=q(k.x+k.y,k.y-k.x).b(-7.5/A).a(g);d.beginPath();d.lineWidth=b?3:1;d.strokeStyle="rgba("+this.color+",.8)";this.a([h,g,aa]).a([g,k]);d.stroke()};this.a=function(a){for(var b=0,h=a.length;b<h;b++)0==b?d.moveTo(a[b].x,a[b].y):d.lineTo(a[b].x,a[b].y);return this};return this}function T(a){for(var c=0,b=l.vertices.length;c<b;c++)if(l.vertices[c].title==a)return c;return-1};</script>